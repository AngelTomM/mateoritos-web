<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="Equipo Meteoritos - Sobre Nosotros" />
    <title>Sobre Nosotros - Equipo Meteoritos</title>
    <link rel="stylesheet" href="style_pagina3.css" />
  </head>
  <body>
    <section class="about-us-section">
      <div class="header-content">
        <!doctype html>
        <html lang="es">
          <head>
            <meta charset="utf-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title data-i18n="page3.title">Team</title>
            <link rel="stylesheet" href="style_3.css">
          </head>
          <body>
            <div class="background"></div>
            <div class="meteoro-top"></div>
            <div class="meteoro-bottom"></div>

            <div class="rectangle"></div>

            <h1 class="titulo" id="page-title">Equipo Mateoritos</h1>
            <div class="team" id="team-name">Mateoritos</div>
            <div class="descripcion" id="team-desc">Aplicación de ejemplo para la demostración</div>

            <!-- member ellipses (background images) -->
            <div class="ellipse mica" data-member="mica"></div>
            <div class="ellipse tomas" data-member="tomas"></div>
            <div class="ellipse joaquin" data-member="joaquin"></div>
            <div class="ellipse ignacio" data-member="ignacio"></div>
            <div class="ellipse simon" data-member="simon"></div>
            <div class="ellipse malena" data-member="malena"></div>

            <!-- names positioned under ellipses -->
            <div class="nombre mica" id="name-mica">Mica</div>
            <div class="nombre simon" id="name-simon">Simon</div>
            <div class="nombre malena" id="name-malena">Malena</div>
            <div class="nombre ignacio" id="name-ignacio">Ignacio</div>
            <div class="nombre joaquin" id="name-joaquin">Joaquin</div>
            <div class="nombre tomas" id="name-tomas">Tomas</div>

            <div class="logo-unsl"></div>
            <div class="logo-fica"></div>

            <div class="footer"> <div id="footer-text">Universidad Nacional de San Luis - FICA</div></div>

            <button id="back-btn" style="position:absolute; left:20px; top:50%; transform:translateY(-50%); z-index:20;">Volver al inicio</button>

            <script src="../i18n/loader.js"></script>
            <script>
              // populate texts from i18n
              i18n.load().then(() => {
                const t = i18n.t;
                document.getElementById('page-title').textContent = t('page3.title');
                document.getElementById('team-name').textContent = t('page3.teamName');
                document.getElementById('team-desc').textContent = t('page3.description');

                const members = t('page3.members');
                // members is expected as array of { id: 'mica', name: 'Mica' }
                members.forEach(m => {
                  const nameEl = document.getElementById('name-' + m.id);
                  if (nameEl) nameEl.textContent = m.name;
                  // set ellipse background if element exists
                  const el = document.querySelector('.ellipse.' + m.id);
                  if (el) {
                    el.style.backgroundImage = `url('../IMG.${m.id}.png')`;
                  }
                });
              });

              document.getElementById('back-btn').addEventListener('click', () => {
                window.location.href = '../index_new.html';
              });
            </script>
          </body>
        </html>
            i++;
            if(i < basePaths.length){
              img.src = basePaths[i];
            } else {
              // final fallback: remove broken image or set placeholder
              img.onerror = null;
              img.src = '';
              img.style.display = 'none';
            }
          };
          img.src = basePaths[0];
          return img;
        }

        (d.members||[]).forEach(name => {
          const candidateBase = (function(){
            // build candidate filenames based on common patterns
            // prefer the repository naming: IMG.Name.jpg
            const tokens = name.split(/\s+/).filter(Boolean);
            // try variants: Last token or First token depending
            const prefer = tokens.length ? tokens[tokens.length-1] : name;
            // normalize: remove diacritics for one variant
            const norm = prefer.normalize('NFD').replace(/\p{Diacritic}/gu, '');
            const variants = [prefer, norm, prefer.toLowerCase(), norm.toLowerCase(), prefer.toUpperCase()];
            const bases = [];
            variants.forEach(v => {
              if(!v) return;
              bases.push(`../IMG.${v}.png`);
            });
            // explicit PNG names
            bases.push('../IMG.Ignacio.png','../IMG.Joaquin.png','../IMG.Malena.png','../IMG.mica.png','../IMG.Simon.png','../IMG.Tomas.png');
            // remove duplicates
            return Array.from(new Set(bases));
          })();

          const photoDiv = document.createElement('div');
          photoDiv.className = 'member-photo';
          const imgEl = makeImgWithFallback(candidateBase);
          imgEl.alt = `Foto de ${name}`;
          photoDiv.appendChild(imgEl);

          const nameP = document.createElement('p');
          nameP.className = 'member-name';
          nameP.textContent = name;

          const card = document.createElement('div');
          card.className = 'member-card';
          card.appendChild(photoDiv);
          card.appendChild(nameP);
          membersCont.appendChild(card);
        });

        window.addEventListener('storage', async(ev)=>{
          if(ev.key === 'mateoritos_lang'){
            await i18n.load();
            const d2 = i18n.t('page3');
            document.getElementById('page3-title').textContent = d2.title;
            document.getElementById('page3-team-name').textContent = d2.team_name;
            document.getElementById('page3-team-desc').textContent = d2.team_description;
            document.getElementById('page3-footer').textContent = d2.footer;
            const root2 = i18n.t();
            const backText2 = (root2 && root2.back) ? root2.back : 'Volver al inicio';
            const backBtn2 = document.getElementById('page3-back-btn'); if (backBtn2) backBtn2.textContent = backText2;
            membersCont.innerHTML = '';
            (d2.members||[]).forEach(name => {
              const candidateBase = (function(){
                const tokens = name.split(/\s+/).filter(Boolean);
                const prefer = tokens.length ? tokens[tokens.length-1] : name;
                const norm = prefer.normalize('NFD').replace(/\p{Diacritic}/gu, '');
                const variants = [prefer, norm, prefer.toLowerCase(), norm.toLowerCase(), prefer.toUpperCase()];
                const bases = [];
                variants.forEach(v => {
                  if(!v) return;
                  bases.push(`../IMG.${v}.png`);
                });
                bases.push('../IMG.Ignacio.png','../IMG.Joaquin.png','../IMG.Malena.png','../IMG.mica.png','../IMG.Simon.png','../IMG.Tomas.png');
                return Array.from(new Set(bases));
              })();
              const photoDiv = document.createElement('div');
              photoDiv.className = 'member-photo';
              const imgEl = makeImgWithFallback(candidateBase);
              imgEl.alt = `Foto de ${name}`;
              photoDiv.appendChild(imgEl);
              const nameP = document.createElement('p');
              nameP.className = 'member-name';
              nameP.textContent = name;
              const card = document.createElement('div');
              card.className = 'member-card';
              card.appendChild(photoDiv);
              card.appendChild(nameP);
              membersCont.appendChild(card);
            });
          }
        });
      })();
    </script>
  </body>
</html>